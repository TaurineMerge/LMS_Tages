<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# adminPanel

```go
import "adminPanel"
```

Пакет main \- точка входа для Admin Panel API

Admin Panel \- это веб\-сервис для управления учебным контентом, предоставляющий REST API для работы с категориями, курсами и уроками.

Сервис включает в себя:

- Аутентификацию через JWT\-токены
- OpenTelemetry для трассировки запросов
- Swagger UI для документации API
- Middleware для CORS, логирования и обработки ошибок

Пример использования:

```
# Запуск сервера
go run main.go

# Доступ к Swagger UI
http://localhost:4000/swagger/

# Health check
http://localhost:4000/health
```

## Index



# config

```go
import "adminPanel/config"
```

Package config предоставляет управление конфигурацией для Admin Panel.

Пакет поддерживает загрузку конфигурации из переменных окружения с разумными значениями по умолчанию и валидацией. Поддерживаются два способа конфигурации БД:

- DATABASE\_URL: полная строка подключения \(имеет приоритет\)
- Отдельные DB\_\* переменные: DB\_HOST, DB\_PORT, DB\_USER, DB\_PASSWORD, DB\_NAME

### Переменные окружения

База данных:

```
DATABASE_URL           - Полная строка подключения PostgreSQL
DB_HOST                - Хост базы данных (обязательно, если DATABASE_URL не задан)
DB_PORT                - Порт базы данных (по умолчанию: 5432)
DB_USER                - Пользователь БД (обязательно, если DATABASE_URL не задан)
DB_PASSWORD            - Пароль БД (обязательно, если DATABASE_URL не задан)
DB_NAME                - Имя базы данных (обязательно, если DATABASE_URL не задан)
DB_SSLMODE             - Режим SSL (по умолчанию: disable)
DATABASE_POOL_MIN_SIZE - Минимальный размер пула соединений (по умолчанию: 5)
DATABASE_POOL_MAX_SIZE - Максимальный размер пула соединений (по умолчанию: 20)
```

Сервер:

```
API_ADDRESS - Адрес для прослушивания (по умолчанию: :4000)
APP_NAME    - Название приложения (по умолчанию: Admin Panel API)
ROOT_PATH   - Корневой путь URL (по умолчанию: /admin)
DEBUG       - Режим отладки (по умолчанию: false)
```

Keycloak:

```
KEYCLOAK_ISSUER_URL    - URL издателя токенов для валидации
KEYCLOAK_AUDIENCE      - Ожидаемая аудитория JWT
KEYCLOAK_JWKS_URL      - URL эндпоинта JWKS (генерируется автоматически из issuer)
KEYCLOAK_CLIENT_ID     - OAuth client ID
KEYCLOAK_CLIENT_SECRET - OAuth client secret
KEYCLOAK_APP_NAME      - Название приложения для OAuth
```

CORS:

```
CORS_ALLOW_ORIGINS     - Разрешённые origins (по умолчанию: *)
CORS_ALLOW_METHODS     - Разрешённые методы (по умолчанию: GET,POST,PUT,DELETE,OPTIONS)
CORS_ALLOW_HEADERS     - Разрешённые заголовки
CORS_ALLOW_CREDENTIALS - Разрешить credentials (по умолчанию: false)
CORS_EXPOSE_HEADERS    - Экспонируемые заголовки (по умолчанию: Content-Length)
```

OpenTelemetry:

```
OTEL_EXPORTER_OTLP_ENDPOINT - Эндпоинт OTLP коллектора
OTEL_SERVICE_NAME           - Имя сервиса (по умолчанию: admin-panel)
OTEL_EXPORTER_OTLP_PROTOCOL - Протокол OTLP (по умолчанию: grpc)
```

### Использование

```
settings := config.NewSettings()
if err := settings.Validate(); err != nil {
    log.Fatalf("Ошибка конфигурации: %v", err)
}
```

## Index

- [type CORSConfig](<#CORSConfig>)
- [type DatabaseConfig](<#DatabaseConfig>)
  - [func \(d \*DatabaseConfig\) URL\(\) string](<#DatabaseConfig.URL>)
- [type KeycloakConfig](<#KeycloakConfig>)
- [type OTelConfig](<#OTelConfig>)
- [type ServerConfig](<#ServerConfig>)
- [type Settings](<#Settings>)
  - [func NewSettings\(\) \*Settings](<#NewSettings>)
  - [func \(s \*Settings\) DatabaseURL\(\) string](<#Settings.DatabaseURL>)
  - [func \(s \*Settings\) GetCORSOrigins\(\) \[\]string](<#Settings.GetCORSOrigins>)
  - [func \(s \*Settings\) Validate\(\) error](<#Settings.Validate>)


<a name="CORSConfig"></a>
## type [CORSConfig](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L113-L119>)

CORSConfig содержит настройки Cross\-Origin Resource Sharing.

```go
type CORSConfig struct {
    AllowOrigins     string // Список разрешённых origins через запятую
    AllowMethods     string // Список разрешённых HTTP методов через запятую
    AllowHeaders     string // Список разрешённых заголовков через запятую
    AllowCredentials bool   // Разрешить ли передачу credentials
    ExposeHeaders    string // Список экспонируемых заголовков через запятую
}
```

<a name="DatabaseConfig"></a>
## type [DatabaseConfig](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L73-L82>)

DatabaseConfig содержит настройки подключения к PostgreSQL.

Конфигурация может быть предоставлена либо через переменную окружения DATABASE\_URL, либо через отдельные DB\_\* переменные. Когда DATABASE\_URL задан, он имеет приоритет над отдельными переменными.

```go
type DatabaseConfig struct {
    Host        string // Хост сервера базы данных
    Port        int    // Порт сервера базы данных
    User        string // Имя пользователя базы данных
    Password    string // Пароль базы данных
    Name        string // Имя базы данных
    SSLMode     string // Режим SSL (disable, require, verify-ca, verify-full)
    MinPoolSize int    // Минимальное количество соединений в пуле
    MaxPoolSize int    // Максимальное количество соединений в пуле
}
```

<a name="DatabaseConfig.URL"></a>
### func \(\*DatabaseConfig\) [URL](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L87>)

```go
func (d *DatabaseConfig) URL() string
```

URL возвращает строку подключения к PostgreSQL в стандартном формате.

Формат: postgresql://user:password@host:port/dbname?sslmode=value

<a name="KeycloakConfig"></a>
## type [KeycloakConfig](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L103-L110>)

KeycloakConfig содержит настройки аутентификации через Keycloak.

```go
type KeycloakConfig struct {
    IssuerURL    string // URL издателя токенов для валидации
    Audience     string // Ожидаемый claim audience в JWT
    JWKSURL      string // URL эндпоинта JSON Web Key Set
    ClientID     string // OAuth2 client ID
    ClientSecret string // OAuth2 client secret
    AppName      string // Название приложения для OAuth2
}
```

<a name="OTelConfig"></a>
## type [OTelConfig](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L95-L100>)

OTelConfig содержит настройки трассировки OpenTelemetry.

```go
type OTelConfig struct {
    Endpoint    string // URL эндпоинта OTLP коллектора
    ServiceName string // Имя сервиса для трасс
    Protocol    string // Протокол (grpc, http)
    Enabled     bool   // Включена ли трассировка
}
```

<a name="ServerConfig"></a>
## type [ServerConfig](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L122-L126>)

ServerConfig содержит настройки HTTP сервера.

```go
type ServerConfig struct {
    Address  string // Адрес для прослушивания (например, ":4000")
    AppName  string // Название приложения
    RootPath string // Корневой путь URL
}
```

<a name="Settings"></a>
## type [Settings](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L132-L139>)

Settings является главным контейнером конфигурации приложения.

Объединяет все подсекции конфигурации и предоставляет методы валидации и доступа к значениям конфигурации.

```go
type Settings struct {
    Database DatabaseConfig // Настройки подключения к БД
    OTel     OTelConfig     // Настройки OpenTelemetry
    Keycloak KeycloakConfig // Настройки аутентификации Keycloak
    CORS     CORSConfig     // Настройки CORS
    Server   ServerConfig   // Настройки HTTP сервера
    Debug    bool
}
```

<a name="NewSettings"></a>
### func [NewSettings](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L176>)

```go
func NewSettings() *Settings
```

NewSettings создает и возвращает новую конфигурацию

Функция читает параметры из переменных окружения. Приоритет для базы данных: DATABASE\_URL \> отдельные DB\_\* переменные

Возвращает:

- \*Settings: указатель на структуру конфигурации

<a name="Settings.DatabaseURL"></a>
### func \(\*Settings\) [DatabaseURL](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L408>)

```go
func (s *Settings) DatabaseURL() string
```

DatabaseURL возвращает URL подключения к базе данных Deprecated: используйте Settings.Database.URL\(\)

<a name="Settings.GetCORSOrigins"></a>
### func \(\*Settings\) [GetCORSOrigins](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L395>)

```go
func (s *Settings) GetCORSOrigins() []string
```

GetCORSOrigins возвращает список разрешенных origins для CORS

Преобразует строку origins в слайс, разделяя по запятым и удаляя пробелы. Поддерживает wildcard "\*".

Возвращает:

- \[\]string: слайс с origins

<a name="Settings.Validate"></a>
### func \(\*Settings\) [Validate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/config/config.go#L145>)

```go
func (s *Settings) Validate() error
```

Validate проверяет обязательные параметры конфигурации

Возвращает:

- error: ошибка валидации \(если есть\)

# database

```go
import "adminPanel/database"
```

Package database предоставляет функции для работы с PostgreSQL

Пакет реализует:

- Инициализацию пула соединений
- Выполнение SQL\-запросов
- Преобразование результатов в map
- Управление жизненным циклом соединений

Основные функции:

- InitDB: инициализация пула соединений
- Close: закрытие пула
- FetchOne: выполнение запроса с одним результатом
- FetchAll: выполнение запроса с несколькими результатами
- Execute: выполнение запроса без результата
- ExecuteReturning: выполнение запроса с возвратом результата

## Index

- [func Close\(\)](<#Close>)
- [type Database](<#Database>)
  - [func GetDB\(\) \*Database](<#GetDB>)
  - [func InitDB\(settings \*config.Settings\) \(\*Database, error\)](<#InitDB>)
  - [func \(db \*Database\) Execute\(ctx context.Context, query string, args ...interface\{\}\) \(int64, error\)](<#Database.Execute>)
  - [func \(db \*Database\) ExecuteReturning\(ctx context.Context, query string, args ...interface\{\}\) \(map\[string\]interface\{\}, error\)](<#Database.ExecuteReturning>)
  - [func \(db \*Database\) FetchAll\(ctx context.Context, query string, args ...interface\{\}\) \(\[\]map\[string\]interface\{\}, error\)](<#Database.FetchAll>)
  - [func \(db \*Database\) FetchOne\(ctx context.Context, query string, args ...interface\{\}\) \(map\[string\]interface\{\}, error\)](<#Database.FetchOne>)


<a name="Close"></a>
## func [Close](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L98>)

```go
func Close()
```

Close закрывает пул соединений с базой данных

Функция освобождает все ресурсы, связанные с пулом соединений. Должна вызываться при завершении работы приложения.

<a name="Database"></a>
## type [Database](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L39-L41>)

Database \- обертка над пулом соединений PostgreSQL

Структура предоставляет удобный интерфейс для выполнения SQL\-запросов и управления соединениями.

```go
type Database struct {
    Pool *pgxpool.Pool
}
```

<a name="GetDB"></a>
### func [GetDB](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L109>)

```go
func GetDB() *Database
```

GetDB возвращает текущий экземпляр базы данных

Возвращает:

- \*Database: указатель на экземпляр базы данных

<a name="InitDB"></a>
### func [InitDB](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L58>)

```go
func InitDB(settings *config.Settings) (*Database, error)
```

InitDB инициализирует пул соединений с PostgreSQL

Функция создает и настраивает пул соединений на основе конфигурационных параметров.

Параметры:

- settings: конфигурация приложения

Возвращает:

- \*Database: указатель на экземпляр базы данных
- error: ошибка инициализации \(если есть\)

<a name="Database.Execute"></a>
### func \(\*Database\) [Execute](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L268>)

```go
func (db *Database) Execute(ctx context.Context, query string, args ...interface{}) (int64, error)
```

Execute выполняет SQL\-запрос без возврата результата

Функция аналогична execute из Python. Используется для INSERT, UPDATE, DELETE и других запросов, не возвращающих данные.

Параметры:

- ctx: контекст выполнения
- query: SQL\-запрос
- args: аргументы для запроса

Возвращает:

- int64: количество затронутых строк
- error: ошибка выполнения \(если есть\)

<a name="Database.ExecuteReturning"></a>
### func \(\*Database\) [ExecuteReturning](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L321>)

```go
func (db *Database) ExecuteReturning(ctx context.Context, query string, args ...interface{}) (map[string]interface{}, error)
```

ExecuteReturning выполняет SQL\-запрос с возвратом результата

Функция аналогична execute\_returning из Python. Используется для запросов, которые возвращают данные \(например, INSERT ... RETURNING\).

Параметры:

- ctx: контекст выполнения
- query: SQL\-запрос
- args: аргументы для запроса

Возвращает:

- map\[string\]interface\{\}: строка результата
- error: ошибка выполнения \(если есть\)

<a name="Database.FetchAll"></a>
### func \(\*Database\) [FetchAll](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L208>)

```go
func (db *Database) FetchAll(ctx context.Context, query string, args ...interface{}) ([]map[string]interface{}, error)
```

FetchAll выполняет SQL\-запрос и возвращает все строки результата

Функция аналогична fetch\_all из Python. Возвращает все строки результата в виде слайса map.

Параметры:

- ctx: контекст выполнения
- query: SQL\-запрос
- args: аргументы для запроса

Возвращает:

- \[\]map\[string\]interface\{\}: слайс строк результата
- error: ошибка выполнения \(если есть\)

<a name="Database.FetchOne"></a>
### func \(\*Database\) [FetchOne](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/database/database.go#L191>)

```go
func (db *Database) FetchOne(ctx context.Context, query string, args ...interface{}) (map[string]interface{}, error)
```

FetchOne выполняет SQL\-запрос и возвращает одну строку результата

Функция аналогична fetch\_one из Python. Возвращает первую строку результата или nil, если строк нет.

Параметры:

- ctx: контекст выполнения
- query: SQL\-запрос
- args: аргументы для запроса

Возвращает:

- map\[string\]interface\{\}: строка результата или nil
- error: ошибка выполнения \(если есть\)

# exceptions

```go
import "adminPanel/exceptions"
```

Package exceptions содержит типы ошибок приложения

Пакет предоставляет:

- AppError: базовую структуру для всех ошибок
- Конструкторы для стандартных ошибок
- Единый формат ошибок для API

Стандартные ошибки:

- NotFoundError: ресурс не найден
- ConflictError: конфликт данных
- ValidationError: ошибка валидации
- UnauthorizedError: ошибка авторизации
- InternalError: внутренняя ошибка сервера

## Index

- [type AppError](<#AppError>)
  - [func ConflictError\(message string\) \*AppError](<#ConflictError>)
  - [func InternalError\(message string\) \*AppError](<#InternalError>)
  - [func NewAppError\(message string, statusCode int, code string\) \*AppError](<#NewAppError>)
  - [func NotFoundError\(resource, identifier string\) \*AppError](<#NotFoundError>)
  - [func UnauthorizedError\(message string\) \*AppError](<#UnauthorizedError>)
  - [func ValidationError\(message string\) \*AppError](<#ValidationError>)
  - [func \(e \*AppError\) Error\(\) string](<#AppError.Error>)


<a name="AppError"></a>
## type [AppError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L22-L26>)

AppError \- базовая структура для всех ошибок приложения

Содержит:

- Message: текстовое описание ошибки
- StatusCode: HTTP статус\-код
- Code: строковый код ошибки для программной обработки

```go
type AppError struct {
    Message    string `json:"error"`
    StatusCode int    `json:"-"`
    Code       string `json:"code"`
}
```

<a name="ConflictError"></a>
### func [ConflictError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L75>)

```go
func ConflictError(message string) *AppError
```

ConflictError создает ошибку "Конфликт данных"

Используется при попытке создать дубликат или нарушении уникальности данных.

Параметры:

- message: описание конфликта

Возвращает:

- \*AppError: ошибка с кодом 409

<a name="InternalError"></a>
### func [InternalError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L114>)

```go
func InternalError(message string) *AppError
```

InternalError создает ошибку "Внутренняя ошибка сервера"

Используется для неожиданных ошибок, возникающих на сервере.

Параметры:

- message: описание внутренней ошибки

Возвращает:

- \*AppError: ошибка с кодом 500

<a name="NewAppError"></a>
### func [NewAppError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L41>)

```go
func NewAppError(message string, statusCode int, code string) *AppError
```

NewAppError создает новую ошибку приложения

Параметры:

- message: текстовое описание ошибки
- statusCode: HTTP статус\-код
- code: строковый код ошибки

Возвращает:

- \*AppError: указатель на новую ошибку

<a name="NotFoundError"></a>
### func [NotFoundError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L57>)

```go
func NotFoundError(resource, identifier string) *AppError
```

NotFoundError создает ошибку "Ресурс не найден"

Параметры:

- resource: тип ресурса \(например, "Course", "Category"\)
- identifier: идентификатор ресурса \(опционально\)

Возвращает:

- \*AppError: ошибка с кодом 404

<a name="UnauthorizedError"></a>
### func [UnauthorizedError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L101>)

```go
func UnauthorizedError(message string) *AppError
```

UnauthorizedError создает ошибку "Неавторизованный доступ"

Используется при отсутствии или невалидности аутентификации.

Параметры:

- message: описание ошибки авторизации

Возвращает:

- \*AppError: ошибка с кодом 401

<a name="ValidationError"></a>
### func [ValidationError](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L88>)

```go
func ValidationError(message string) *AppError
```

ValidationError создает ошибку "Ошибка валидации"

Используется при нарушении правил валидации данных.

Параметры:

- message: описание ошибки валидации

Возвращает:

- \*AppError: ошибка с кодом 422

<a name="AppError.Error"></a>
### func \(\*AppError\) [Error](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/exceptions/exceptions.go#L28>)

```go
func (e *AppError) Error() string
```



# handlers

```go
import "adminPanel/handlers"
```

Package handlers содержит HTTP\-обработчики для всех маршрутов приложения. Этот пакет предоставляет обработчики для health check, категорий, курсов и уроков.

Package handlers содержит HTTP\-обработчики для всех маршрутов приложения. Этот пакет предоставляет обработчики для health check, категорий, курсов и уроков.

## Index

- [type CategoryHandler](<#CategoryHandler>)
  - [func NewCategoryHandler\(categoryService \*services.CategoryService\) \*CategoryHandler](<#NewCategoryHandler>)
  - [func \(h \*CategoryHandler\) RegisterRoutes\(router fiber.Router\)](<#CategoryHandler.RegisterRoutes>)
- [type CourseHandler](<#CourseHandler>)
  - [func NewCourseHandler\(courseService \*services.CourseService\) \*CourseHandler](<#NewCourseHandler>)
  - [func \(h \*CourseHandler\) RegisterRoutes\(router fiber.Router\)](<#CourseHandler.RegisterRoutes>)
- [type HealthHandler](<#HealthHandler>)
  - [func NewHealthHandler\(db \*database.Database\) \*HealthHandler](<#NewHealthHandler>)
  - [func \(h \*HealthHandler\) DBHealthCheck\(c \*fiber.Ctx\) error](<#HealthHandler.DBHealthCheck>)
  - [func \(h \*HealthHandler\) HealthCheck\(c \*fiber.Ctx\) error](<#HealthHandler.HealthCheck>)
  - [func \(h \*HealthHandler\) RegisterRoutes\(router fiber.Router\)](<#HealthHandler.RegisterRoutes>)
- [type LessonHandler](<#LessonHandler>)
  - [func NewLessonHandler\(lessonService \*services.LessonService\) \*LessonHandler](<#NewLessonHandler>)
  - [func \(h \*LessonHandler\) RegisterRoutes\(router fiber.Router\)](<#LessonHandler.RegisterRoutes>)


<a name="CategoryHandler"></a>
## type [CategoryHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/categories.go#L28-L30>)

CategoryHandler \- HTTP обработчик для операций с категориями

Обработчик предоставляет REST API для управления категориями курсов:

- GET /categories \- получение списка категорий
- POST /categories \- создание новой категории
- GET /categories/:id \- получение категории по ID
- PUT /categories/:id \- обновление категории
- DELETE /categories/:id \- удаление категории

Особенности:

- Валидация входных данных
- Интеграция с OpenTelemetry для трассировки
- Стандартизированный формат ответов
- Централизованная обработка ошибок

```go
type CategoryHandler struct {
    // contains filtered or unexported fields
}
```

<a name="NewCategoryHandler"></a>
### func [NewCategoryHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/categories.go#L39>)

```go
func NewCategoryHandler(categoryService *services.CategoryService) *CategoryHandler
```

NewCategoryHandler создает новый HTTP обработчик для категорий

Параметры:

- categoryService: сервис для работы с категориями

Возвращает:

- \*CategoryHandler: указатель на новый обработчик

<a name="CategoryHandler.RegisterRoutes"></a>
### func \(\*CategoryHandler\) [RegisterRoutes](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/categories.go#L51>)

```go
func (h *CategoryHandler) RegisterRoutes(router fiber.Router)
```

RegisterRoutes регистрирует маршруты для категорий

Регистрирует все необходимые маршруты в указанном роутере.

Параметры:

- router: роутер Fiber для регистрации маршрутов

<a name="CourseHandler"></a>
## type [CourseHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/courses.go#L32-L34>)

CourseHandler \- HTTP обработчик для операций с курсами

Обработчик предоставляет REST API для управления курсами:

- GET /categories/:category\_id/courses \- получение курсов категории
- POST /categories/:category\_id/courses \- создание курса
- GET /categories/:category\_id/courses/:id \- получение курса
- PUT /categories/:category\_id/courses/:id \- обновление курса
- DELETE /categories/:category\_id/courses/:id \- удаление курса

Особенности:

- Фильтрация курсов по уровню и видимости
- Пагинация результатов
- Валидация входных данных
- Интеграция с OpenTelemetry для трассировки
- Стандартизированный формат ответов

```go
type CourseHandler struct {
    // contains filtered or unexported fields
}
```

<a name="NewCourseHandler"></a>
### func [NewCourseHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/courses.go#L43>)

```go
func NewCourseHandler(courseService *services.CourseService) *CourseHandler
```

NewCourseHandler создает новый HTTP обработчик для курсов

Параметры:

- courseService: сервис для работы с курсами

Возвращает:

- \*CourseHandler: указатель на новый обработчик

<a name="CourseHandler.RegisterRoutes"></a>
### func \(\*CourseHandler\) [RegisterRoutes](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/courses.go#L56>)

```go
func (h *CourseHandler) RegisterRoutes(router fiber.Router)
```

RegisterRoutes регистрирует маршруты для курсов

Регистрирует все необходимые маршруты в указанном роутере. Все маршруты включают в себя category\_id в пути.

Параметры:

- router: роутер Fiber для регистрации маршрутов

<a name="HealthHandler"></a>
## type [HealthHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/health.go#L18-L20>)

HealthHandler \- обработчик для health check запросов. Предоставляет информацию о состоянии приложения и базы данных.

```go
type HealthHandler struct {
    // contains filtered or unexported fields
}
```

<a name="NewHealthHandler"></a>
### func [NewHealthHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/health.go#L29>)

```go
func NewHealthHandler(db *database.Database) *HealthHandler
```

NewHealthHandler создает новый обработчик health check.

Параметры:

- db: указатель на соединение с базой данных

Возвращает:

- \*HealthHandler: указатель на новый экземпляр HealthHandler

<a name="HealthHandler.DBHealthCheck"></a>
### func \(\*HealthHandler\) [DBHealthCheck](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/health.go#L76>)

```go
func (h *HealthHandler) DBHealthCheck(c *fiber.Ctx) error
```

DBHealthCheck проверяет состояние подключения к базе данных. Этот метод не требует аутентификации и доступен для всех.

HTTP маршрут: GET /health/db

Возвращает:

- JSON со статусом приложения и состоянием базы данных
- HTTP статус 200 OK, если база данных доступна
- HTTP статус 503 Service Unavailable, если база данных недоступна

<a name="HealthHandler.HealthCheck"></a>
### func \(\*HealthHandler\) [HealthCheck](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/health.go#L52>)

```go
func (h *HealthHandler) HealthCheck(c *fiber.Ctx) error
```

HealthCheck возвращает статус приложения. Этот метод не требует аутентификации и доступен для всех.

HTTP маршрут: GET /health

Возвращает:

- JSON с общим статусом приложения и версией
- HTTP статус 200 OK

<a name="HealthHandler.RegisterRoutes"></a>
### func \(\*HealthHandler\) [RegisterRoutes](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/health.go#L39>)

```go
func (h *HealthHandler) RegisterRoutes(router fiber.Router)
```

RegisterRoutes регистрирует маршруты для health check.

Параметры:

- router: маршрутизатор Fiber для регистрации маршрутов

<a name="LessonHandler"></a>
## type [LessonHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/lessons.go#L30-L32>)

LessonHandler \- HTTP обработчик для операций с уроками

Обработчик предоставляет REST API для управления уроками:

- GET /categories/:category\_id/courses/:course\_id/lessons \- получение уроков курса
- POST /categories/:category\_id/courses/:course\_id/lessons \- создание урока
- GET /categories/:category\_id/courses/:course\_id/lessons/:id \- получение урока
- PUT /categories/:category\_id/courses/:course\_id/lessons/:id \- обновление урока
- DELETE /categories/:category\_id/courses/:course\_id/lessons/:id \- удаление урока

Особенности:

- Валидация входных данных
- Интеграция с OpenTelemetry для трассировки
- Стандартизированный формат ответов
- Поддержка контента урока в формате JSON

```go
type LessonHandler struct {
    // contains filtered or unexported fields
}
```

<a name="NewLessonHandler"></a>
### func [NewLessonHandler](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/lessons.go#L41>)

```go
func NewLessonHandler(lessonService *services.LessonService) *LessonHandler
```

NewLessonHandler создает новый HTTP обработчик для уроков

Параметры:

- lessonService: сервис для работы с уроками

Возвращает:

- \*LessonHandler: указатель на новый обработчик

<a name="LessonHandler.RegisterRoutes"></a>
### func \(\*LessonHandler\) [RegisterRoutes](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/handlers/lessons.go#L54>)

```go
func (h *LessonHandler) RegisterRoutes(router fiber.Router)
```

RegisterRoutes регистрирует маршруты для уроков

Регистрирует все необходимые маршруты в указанном роутере. Все маршруты включают в себя category\_id и course\_id в пути.

Параметры:

- router: роутер Fiber для регистрации маршрутов

# middleware

```go
import "adminPanel/middleware"
```

Package middleware содержит HTTP middleware для admin panel

Пакет предоставляет:

- Аутентификацию через JWT\-токены
- Валидацию токенов Keycloak
- Обработку ошибок
- CORS настройки

Основные компоненты:

- InitAuth: инициализация аутентификации
- AuthMiddleware: middleware для проверки JWT
- ErrorHandlerMiddleware: middleware для обработки ошибок

Package middleware содержит middleware\-функции для обработки HTTP\-запросов. Этот пакет предоставляет функции для работы с прокси, валидации, аутентификации и обработки ошибок.

Package middleware содержит middleware\-функции для обработки HTTP\-запросов. Этот пакет предоставляет функции для работы с прокси, валидации, аутентификации и обработки ошибок.

## Index

- [func AuthMiddleware\(\) fiber.Handler](<#AuthMiddleware>)
- [func ErrorHandlerMiddleware\(\) fiber.Handler](<#ErrorHandlerMiddleware>)
- [func InitAuth\(\) error](<#InitAuth>)
- [func TrustProxyMiddleware\(\) fiber.Handler](<#TrustProxyMiddleware>)
- [func ValidateMiddleware\(dto interface\{\}\) fiber.Handler](<#ValidateMiddleware>)
- [func ValidateRequest\(dto interface\{\}\) fiber.Handler](<#ValidateRequest>)
- [func ValidateStruct\(dto interface\{\}\) \(map\[string\]string, error\)](<#ValidateStruct>)
- [type AuthConfig](<#AuthConfig>)


<a name="AuthMiddleware"></a>
## func [AuthMiddleware](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/auth.go#L114>)

```go
func AuthMiddleware() fiber.Handler
```

AuthMiddleware \- middleware для проверки JWT\-токенов

Middleware выполняет:

- Проверку наличия Authorization заголовка
- Валидацию JWT\-токена через JWKS
- Проверку issuer и audience
- Сохранение claims в контекст

Пропускает без аутентификации:

- /admin/swagger/\*
- /health
- /favicon.ico
- /admin/swagger/doc.json

Возвращает:

- fiber.Handler: middleware для использования в Fiber

<a name="ErrorHandlerMiddleware"></a>
## func [ErrorHandlerMiddleware](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/error_handler.go#L26>)

```go
func ErrorHandlerMiddleware() fiber.Handler
```

ErrorHandlerMiddleware \- middleware для централизованной обработки ошибок

Middleware перехватывает все ошибки, возникающие в ходе выполнения запроса, и возвращает их в стандартизированном формате.

Обрабатываемые типы ошибок:

- AppError: кастомные ошибки приложения
- fiber.Error: ошибки фреймворка Fiber
- Database errors: ошибки базы данных \(404, 409, 400\)
- Unknown errors: неизвестные ошибки \(500\)

Возвращает:

- fiber.Handler: middleware для использования в Fiber

<a name="InitAuth"></a>
## func [InitAuth](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/auth.go#L52>)

```go
func InitAuth() error
```

InitAuth инициализирует аутентификацию через Keycloak

Функция загружает JWKS ключи из Keycloak и настраивает валидацию JWT\-токенов. При неудачной инициализации аутентификация отключается.

Возвращает:

- error: ошибка инициализации \(если есть\)

<a name="TrustProxyMiddleware"></a>
## func [TrustProxyMiddleware](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/trust_proxy.go#L20>)

```go
func TrustProxyMiddleware() fiber.Handler
```

TrustProxyMiddleware доверяет заголовкам от прокси\-сервера. Этот middleware устанавливает заголовки X\-Forwarded\-For и X\-Real\-IP, которые могут быть установлены прокси\-сервером \(например, nginx\).

Особенности:

- Сохраняет оригинальные IP\-адреса клиентов при работе через прокси
- Устанавливает заголовки, которые могут быть использованы другими middleware
- Должен быть установлен до других middleware, использующих IP\-адреса

Возвращает:

- fiber.Handler: middleware\-функцию для использования в Fiber приложении

<a name="ValidateMiddleware"></a>
## func [ValidateMiddleware](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/validation.go#L112>)

```go
func ValidateMiddleware(dto interface{}) fiber.Handler
```

ValidateMiddleware middleware для валидации DTO. Аналогичен ValidateRequest, но с более простой реализацией.

Параметры:

- dto: тип DTO для валидации

Возвращает:

- fiber.Handler: middleware\-функцию для использования в Fiber приложении

<a name="ValidateRequest"></a>
## func [ValidateRequest](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/validation.go#L61>)

```go
func ValidateRequest(dto interface{}) fiber.Handler
```

ValidateRequest middleware для валидации запроса. Парсит тело запроса в DTO и проверяет его на соответствие правилам валидации.

Параметры:

- dto: тип DTO для валидации \(обычно используется как ValidateRequest\(CreateCategoryDTO\{\}\)\)

Возвращает:

- fiber.Handler: middleware\-функцию для использования в Fiber приложении

<a name="ValidateStruct"></a>
## func [ValidateStruct](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/validation.go#L25>)

```go
func ValidateStruct(dto interface{}) (map[string]string, error)
```

ValidateStruct валидирует структуру DTO и возвращает ошибки валидации.

Параметры:

- dto: интерфейс валидируемой структуры \(должен быть указателем на структуру\)

Возвращает:

- map\[string\]string: карта ошибок валидации, где ключ \- имя поля, значение \- сообщение об ошибке
- error: ошибка, если произошла ошибка при валидации

<a name="AuthConfig"></a>
## type [AuthConfig](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/middleware/auth.go#L33-L37>)

AuthConfig \- конфигурация аутентификации через Keycloak

Содержит параметры для настройки JWT\-аутентификации:

- IssuerURL: URL Keycloak для валидации токенов
- Audience: аудитория для JWT\-токенов
- JWKSURL: URL для получения JWKS ключей

```go
type AuthConfig struct {
    IssuerURL string
    Audience  string
    JWKSURL   string
}
```

# models

```go
import "adminPanel/models"
```

Package models содержит модели данных для передачи и доменные модели

Пакет предоставляет:

- BaseModel: базовую модель с общими полями
- Pagination: модель для пагинации
- Category: модель категории
- Course: модель курса
- Lesson: модель урока
- Response: модели для ответов API

Package models содержит модели данных для API. Этот пакет предоставляет структуры для запросов, ответов и валидации.

## Index

- [type BaseModel](<#BaseModel>)
- [type Category](<#Category>)
- [type CategoryCreate](<#CategoryCreate>)
- [type CategoryResponse](<#CategoryResponse>)
- [type CategoryUpdate](<#CategoryUpdate>)
- [type Course](<#Course>)
- [type CourseCreate](<#CourseCreate>)
- [type CourseFilter](<#CourseFilter>)
- [type CourseResponse](<#CourseResponse>)
- [type CourseUpdate](<#CourseUpdate>)
- [type ErrorDetails](<#ErrorDetails>)
- [type ErrorResponse](<#ErrorResponse>)
- [type HealthResponse](<#HealthResponse>)
- [type Lesson](<#Lesson>)
- [type LessonCreate](<#LessonCreate>)
- [type LessonDetailed](<#LessonDetailed>)
- [type LessonListResponse](<#LessonListResponse>)
- [type LessonResponse](<#LessonResponse>)
- [type LessonUpdate](<#LessonUpdate>)
- [type MessageResponse](<#MessageResponse>)
- [type PaginatedCategoriesResponse](<#PaginatedCategoriesResponse>)
- [type PaginatedCoursesResponse](<#PaginatedCoursesResponse>)
- [type Pagination](<#Pagination>)
- [type StatusOnly](<#StatusOnly>)
- [type ValidationErrorResponse](<#ValidationErrorResponse>)


<a name="BaseModel"></a>
## type [BaseModel](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/base.go#L20-L24>)

BaseModel \- базовая модель, содержащая общие поля для всех сущностей

Включает в себя:

- ID: уникальный идентификатор
- CreatedAt: дата и время создания
- UpdatedAt: дата и время последнего обновления

```go
type BaseModel struct {
    ID        string    `json:"id"`
    CreatedAt time.Time `json:"created_at"`
    UpdatedAt time.Time `json:"updated_at"`
}
```

<a name="Category"></a>
## type [Category](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/category.go#L11-L14>)

Category \- модель категории курсов

Представляет категорию, к которой могут принадлежать курсы. Категория содержит базовую информацию и наследует поля от BaseModel.

Поля:

- BaseModel: встроенная структура с общими полями \(ID, CreatedAt, UpdatedAt\)
- Title: название категории

```go
type Category struct {
    BaseModel
    Title string `json:"title"`
}
```

<a name="CategoryCreate"></a>
## type [CategoryCreate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/category.go#L23-L25>)

CategoryCreate \- DTO для создания новой категории

Используется в запросах на создание категории. Содержит валидацию полей.

Поля:

- Title: название категории \(обязательное, от 1 до 255 символов\)

```go
type CategoryCreate struct {
    Title string `json:"title" validate:"required,min=1,max=255"`
}
```

<a name="CategoryResponse"></a>
## type [CategoryResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/category.go#L45-L48>)

CategoryResponse \- ответ API с одной категорией

Используется для возврата данных об одной категории.

Поля:

- Status: статус ответа \(обычно "success"\)
- Data: объект категории с полной информацией

```go
type CategoryResponse struct {
    Status string   `json:"status"`
    Data   Category `json:"data"`
}
```

<a name="CategoryUpdate"></a>
## type [CategoryUpdate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/category.go#L34-L36>)

CategoryUpdate \- DTO для обновления категории

Используется в запросах на обновление категории. Все поля опциональны \(omitempty\).

Поля:

- Title: новое название категории \(опционально, от 1 до 255 символов\)

```go
type CategoryUpdate struct {
    Title string `json:"title" validate:"omitempty,min=1,max=255"`
}
```

<a name="Course"></a>
## type [Course](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/course.go#L15-L22>)

Course \- модель учебного курса

Представляет учебный курс, который может содержать уроки. Курс принадлежит определенной категории и имеет уровень сложности.

Поля:

- BaseModel: встроенная структура с общими полями \(ID, CreatedAt, UpdatedAt\)
- Title: название курса
- Description: описание курса
- Level: уровень сложности \("hard", "medium", "easy"\)
- CategoryID: уникальный идентификатор категории, к которой принадлежит курс
- Visibility: видимость курса \("draft", "public", "private"\)

```go
type Course struct {
    BaseModel
    Title       string `json:"title"`
    Description string `json:"description"`
    Level       string `json:"level"`
    CategoryID  string `json:"category_id"`
    Visibility  string `json:"visibility"`
}
```

<a name="CourseCreate"></a>
## type [CourseCreate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/course.go#L35-L41>)

CourseCreate \- DTO для создания нового курса

Используется в запросах на создание курса. Содержит валидацию полей.

Поля:

- Title: название курса \(обязательное, от 1 до 255 символов\)
- Description: описание курса \(опционально\)
- Level: уровень сложности \(опционально, "hard", "medium", "easy"\)
- CategoryID: идентификатор категории \(обязательное, UUID v4\)
- Visibility: видимость курса \(опционально, "draft", "public", "private"\)

```go
type CourseCreate struct {
    Title       string `json:"title" validate:"required,min=1,max=255"`
    Description string `json:"description"`
    Level       string `json:"level" validate:"omitempty,oneof=hard medium easy"`
    CategoryID  string `json:"category_id" validate:"required,uuid4"`
    Visibility  string `json:"visibility" validate:"omitempty,oneof=draft public private"`
}
```

<a name="CourseFilter"></a>
## type [CourseFilter](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/course.go#L102-L108>)

CourseFilter \- фильтр для поиска курсов

Используется для фильтрации курсов по различным критериям: уровень сложности, видимость, категория, пагинация.

Поля:

- Level: уровень сложности курса \("hard", "medium", "easy"\)
- Visibility: видимость курса \("draft", "public", "private"\)
- CategoryID: уникальный идентификатор категории для фильтрации
- Page: номер страницы для пагинации \(минимум 1\)
- Limit: количество элементов на странице \(от 1 до 100\)

```go
type CourseFilter struct {
    Level      string `query:"level"`
    Visibility string `query:"visibility"`
    CategoryID string `query:"category_id" validate:"omitempty,uuid4"`
    Page       int    `query:"page" validate:"min=1"`
    Limit      int    `query:"limit" validate:"min=1,max=100"`
}
```

<a name="CourseResponse"></a>
## type [CourseResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/course.go#L69-L72>)

CourseResponse \- ответ API с одним курсом

Используется для возврата данных об одном курсе.

Поля:

- Status: статус ответа \(обычно "success"\)
- Data: объект курса с полной информацией

```go
type CourseResponse struct {
    Status string `json:"status"`
    Data   Course `json:"data"`
}
```

<a name="CourseUpdate"></a>
## type [CourseUpdate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/course.go#L54-L60>)

CourseUpdate \- DTO для обновления курса

Используется в запросах на обновление курса. Все поля опциональны \(omitempty\).

Поля:

- Title: новое название курса \(опционально, от 1 до 255 символов\)
- Description: новое описание курса \(опционально\)
- Level: новый уровень сложности \(опционально, "hard", "medium", "easy"\)
- CategoryID: новый идентификатор категории \(опционально, UUID v4\)
- Visibility: новая видимость курса \(опционально, "draft", "public", "private"\)

```go
type CourseUpdate struct {
    Title       string `json:"title" validate:"omitempty,min=1,max=255"`
    Description string `json:"description"`
    Level       string `json:"level" validate:"omitempty,oneof=hard medium easy"`
    CategoryID  string `json:"category_id" validate:"omitempty,uuid4"`
    Visibility  string `json:"visibility" validate:"omitempty,oneof=draft public private"`
}
```

<a name="ErrorDetails"></a>
## type [ErrorDetails](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/response.go#L26-L29>)

ErrorDetails \- детали ошибки

Соответствует объекту error в Swagger спецификации. Содержит код и сообщение об ошибке для стандартизированной обработки на клиенте.

Поля:

- Code: строковый код ошибки для программной обработки \(например, "NOT\_FOUND", "VALIDATION\_ERROR"\)
- Message: понятное человеку описание ошибки

```go
type ErrorDetails struct {
    Code    string `json:"code"`
    Message string `json:"message"`
}
```

<a name="ErrorResponse"></a>
## type [ErrorResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/response.go#L39-L42>)

ErrorResponse \- ответ с ошибкой

Соответствует error envelope в Swagger спецификации. Используется для возврата ошибок API в стандартизированном формате.

Поля:

- Status: статус ответа \(всегда "error"\)
- Error: детализированная информация об ошибке

```go
type ErrorResponse struct {
    Status string       `json:"status"`
    Error  ErrorDetails `json:"error"`
}
```

<a name="HealthResponse"></a>
## type [HealthResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/response.go#L12-L16>)

HealthResponse \- ответ на health check запрос

Используется для проверки работоспособности сервиса. Может включать статус базы данных и версию приложения.

Поля:

- Status: статус работоспособности сервиса \(обычно "ok" или "healthy"\)
- Database: статус подключения к базе данных \(опционально, "connected" или "disconnected"\)
- Version: версия приложения \(обычно semver, например "1.0.0"\)

```go
type HealthResponse struct {
    Status   string `json:"status"`
    Database string `json:"database,omitempty"`
    Version  string `json:"version"`
}
```

<a name="Lesson"></a>
## type [Lesson](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/lesson.go#L13-L18>)

Lesson \- модель урока курса

Представляет урок, который является частью учебного курса. Урок содержит базовую информацию о себе.

Поля:

- BaseModel: встроенная структура с общими полями \(ID, CreatedAt, UpdatedAt\)
- Title: название урока
- CategoryID: уникальный идентификатор категории
- CourseID: уникальный идентификатор курса, к которому принадлежит урок

```go
type Lesson struct {
    BaseModel
    Title      string `json:"title"`
    CategoryID string `json:"category_id"`
    CourseID   string `json:"course_id"`
}
```

<a name="LessonCreate"></a>
## type [LessonCreate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/lesson.go#L53-L57>)

LessonCreate \- DTO для создания нового урока

Используется в запросах на создание урока. Содержит валидацию полей.

Поля:

- Title: название урока \(обязательное, от 1 до 255 символов\)
- CategoryID: идентификатор категории \(опционально, UUID v4\)
- Content: содержимое урока в формате JSON

```go
type LessonCreate struct {
    Title      string                 `json:"title" validate:"required,min=1,max=255"`
    CategoryID string                 `json:"category_id" validate:"omitempty,uuid4"`
    Content    map[string]interface{} `json:"content"`
}
```

<a name="LessonDetailed"></a>
## type [LessonDetailed](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/lesson.go#L27-L30>)

LessonDetailed \- детальная модель урока с контентом

Расширенная модель урока, включающая в себя содержимое урока.

Поля:

- Lesson: встроенная базовая модель урока
- Content: содержимое урока в формате JSON \(map\[string\]interface\{\}\)

```go
type LessonDetailed struct {
    Lesson
    Content map[string]interface{} `json:"content"`
}
```

<a name="LessonListResponse"></a>
## type [LessonListResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/lesson.go#L83-L89>)

LessonListResponse \- ответ со списком уроков

Используется для возврата списка уроков с информацией о пагинации.

Поля:

- Status: статус ответа \(обычно "success"\)
- Data: данные ответа, содержащие список уроков и информацию о пагинации
- Data.Items: массив уроков
- Data.Pagination: информация о пагинации

```go
type LessonListResponse struct {
    Status string `json:"status"`
    Data   struct {
        Items      []Lesson   `json:"items"`
        Pagination Pagination `json:"pagination"`
    }   `json:"data"`
}
```

<a name="LessonResponse"></a>
## type [LessonResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/lesson.go#L39-L42>)

LessonResponse \- ответ API с одним уроком

Используется для возврата данных об одном уроке с его содержимым.

Поля:

- Status: статус ответа \(обычно "success"\)
- Data: объект детального урока с содержимым

```go
type LessonResponse struct {
    Status string         `json:"status"`
    Data   LessonDetailed `json:"data"`
}
```

<a name="LessonUpdate"></a>
## type [LessonUpdate](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/lesson.go#L68-L72>)

LessonUpdate \- DTO для обновления урока

Используется в запросах на обновление урока. Все поля опциональны \(omitempty\).

Поля:

- Title: новое название урока \(опционально, от 1 до 255 символов\)
- CategoryID: новый идентификатор категории \(опционально, UUID v4\)
- Content: новое содержимое урока в формате JSON \(опционально\)

```go
type LessonUpdate struct {
    Title      string                 `json:"title" validate:"omitempty,min=1,max=255"`
    CategoryID string                 `json:"category_id" validate:"omitempty,uuid4"`
    Content    map[string]interface{} `json:"content"`
}
```

<a name="MessageResponse"></a>
## type [MessageResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/response.go#L63-L66>)

MessageResponse \- ответ с текстовым сообщением

Используется для возврата текстовых сообщений от API, например, подтверждений удаления или информационных сообщений.

Поля:

- Status: статус ответа \(обычно "success"\)
- Message: текстовое сообщение для пользователя

```go
type MessageResponse struct {
    Status  string `json:"status"`
    Message string `json:"message"`
}
```

<a name="PaginatedCategoriesResponse"></a>
## type [PaginatedCategoriesResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/category.go#L59-L65>)

PaginatedCategoriesResponse \- пагинированный ответ со списком категорий

Используется для возврата списка категорий с информацией о пагинации.

Поля:

- Status: статус ответа \(обычно "success"\)
- Data: данные ответа, содержащие список категорий и информацию о пагинации
- Data.Items: массив категорий
- Data.Pagination: информация о пагинации

```go
type PaginatedCategoriesResponse struct {
    Status string `json:"status"`
    Data   struct {
        Items      []Category `json:"items"`
        Pagination Pagination `json:"pagination"`
    }   `json:"data"`
}
```

<a name="PaginatedCoursesResponse"></a>
## type [PaginatedCoursesResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/course.go#L83-L89>)

PaginatedCoursesResponse \- ответ со списком курсов

Используется для возврата списка курсов с информацией о пагинации.

Поля:

- Status: статус ответа \(обычно "success"\)
- Data: данные ответа, содержащие список курсов и информацию о пагинации
- Data.Items: массив курсов
- Data.Pagination: информация о пагинации \(текущая страница, общее количество и т.д.\)

```go
type PaginatedCoursesResponse struct {
    Status string `json:"status"`
    Data   struct {
        Items      []Course   `json:"items"`
        Pagination Pagination `json:"pagination"`
    }   `json:"data"`
}
```

<a name="Pagination"></a>
## type [Pagination](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/base.go#L30-L35>)

Pagination \- модель для пагинации результатов

Соответствует объекту Pagination в Swagger спецификации. Используется для постраничного вывода данных.

```go
type Pagination struct {
    Total int `json:"total"`
    Page  int `json:"page"`
    Limit int `json:"limit"`
    Pages int `json:"pages"`
}
```

<a name="StatusOnly"></a>
## type [StatusOnly](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/response.go#L51-L53>)

StatusOnly \- простой ответ с статусом

Используется для подтверждения успешного выполнения операции без необходимости возврата дополнительных данных.

Поля:

- Status: статус выполнения операции \(обычно "success"\)

```go
type StatusOnly struct {
    Status string `json:"status"`
}
```

<a name="ValidationErrorResponse"></a>
## type [ValidationErrorResponse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/models/validation.go#L27-L31>)

ValidationErrorResponse представляет ответ с ошибками валидации. Используется для возврата клиенту информации о том, какие поля не прошли валидацию.

Поля:

- Status: статус ответа \(обычно "error"\)
- Error: детали общей ошибки валидации
- Errors: карта с ошибками валидации для конкретных полей Ключ \- имя поля, Значение \- сообщение об ошибке

Пример использования:

```
{
  "status": "error",
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Validation failed"
  },
  "errors": {
    "title": "Title is required",
    "email": "Invalid email format"
  }
}
```

```go
type ValidationErrorResponse struct {
    Status string            `json:"status"`
    Error  ErrorDetails      `json:"error"`
    Errors map[string]string `json:"errors,omitempty"`
}
```

# repositories

```go
import "adminPanel/repositories"
```

Package repositories содержит реализации слоя доступа к данным \(Data Access Layer\). Этот пакет предоставляет базовые структуры и методы для работы с базой данных, включая CRUD операции и фильтрацию данных.

BaseRepository \- базовый репозиторий, предоставляющий общие методы для всех репозиториев:

- GetByID \- получение записи по ID
- GetAll \- получение всех записей с пагинацией
- Count \- подсчет записей
- Delete \- удаление записи
- Exists \- проверка существования записи
- GetFiltered \- получение записей с фильтрацией

Все методы возвращают сырые данные в формате map\[string\]interface\{\}, что позволяет гибко работать с различными типами данных.

## Index

- [type BaseRepository](<#BaseRepository>)
  - [func NewBaseRepository\(db \*database.Database, tableName, schema string\) \*BaseRepository](<#NewBaseRepository>)
  - [func \(r \*BaseRepository\) Count\(ctx context.Context, whereClause string, params ...interface\{\}\) \(int, error\)](<#BaseRepository.Count>)
  - [func \(r \*BaseRepository\) Delete\(ctx context.Context, id string\) \(bool, error\)](<#BaseRepository.Delete>)
  - [func \(r \*BaseRepository\) Exists\(ctx context.Context, id string\) \(bool, error\)](<#BaseRepository.Exists>)
  - [func \(r \*BaseRepository\) FullTableName\(\) string](<#BaseRepository.FullTableName>)
  - [func \(r \*BaseRepository\) GetAll\(ctx context.Context, limit, offset int, orderBy, orderDir string\) \(\[\]map\[string\]interface\{\}, error\)](<#BaseRepository.GetAll>)
  - [func \(r \*BaseRepository\) GetByID\(ctx context.Context, id string\) \(map\[string\]interface\{\}, error\)](<#BaseRepository.GetByID>)
  - [func \(r \*BaseRepository\) GetFiltered\(ctx context.Context, conditions \[\]string, params \[\]interface\{\}, orderBy, orderDir string\) \(\[\]map\[string\]interface\{\}, error\)](<#BaseRepository.GetFiltered>)
- [type CategoryRepository](<#CategoryRepository>)
  - [func NewCategoryRepository\(db \*database.Database\) \*CategoryRepository](<#NewCategoryRepository>)
  - [func \(r \*CategoryRepository\) CountCoursesForCategory\(ctx context.Context, categoryID string\) \(int, error\)](<#CategoryRepository.CountCoursesForCategory>)
  - [func \(r \*CategoryRepository\) Create\(ctx context.Context, title string\) \(map\[string\]interface\{\}, error\)](<#CategoryRepository.Create>)
  - [func \(r \*CategoryRepository\) GetAllWithCourses\(ctx context.Context\) \(\[\]map\[string\]interface\{\}, error\)](<#CategoryRepository.GetAllWithCourses>)
  - [func \(r \*CategoryRepository\) GetByTitle\(ctx context.Context, title string\) \(map\[string\]interface\{\}, error\)](<#CategoryRepository.GetByTitle>)
  - [func \(r \*CategoryRepository\) Update\(ctx context.Context, id, title string\) \(map\[string\]interface\{\}, error\)](<#CategoryRepository.Update>)
- [type CourseRepository](<#CourseRepository>)
  - [func NewCourseRepository\(db \*database.Database\) \*CourseRepository](<#NewCourseRepository>)
  - [func \(r \*CourseRepository\) Create\(ctx context.Context, course models.CourseCreate\) \(map\[string\]interface\{\}, error\)](<#CourseRepository.Create>)
  - [func \(r \*CourseRepository\) ExistsByCategory\(ctx context.Context, categoryID string\) \(bool, error\)](<#CourseRepository.ExistsByCategory>)
  - [func \(r \*CourseRepository\) GetByCategory\(ctx context.Context, categoryID string\) \(\[\]map\[string\]interface\{\}, error\)](<#CourseRepository.GetByCategory>)
  - [func \(r \*CourseRepository\) GetFiltered\(ctx context.Context, filter models.CourseFilter\) \(\[\]map\[string\]interface\{\}, int, error\)](<#CourseRepository.GetFiltered>)
  - [func \(r \*CourseRepository\) Update\(ctx context.Context, id string, course models.CourseUpdate\) \(map\[string\]interface\{\}, error\)](<#CourseRepository.Update>)
- [type LessonRepository](<#LessonRepository>)
  - [func NewLessonRepository\(db \*database.Database\) \*LessonRepository](<#NewLessonRepository>)
  - [func \(r \*LessonRepository\) CountByCourse\(ctx context.Context, categoryID, courseID string\) \(int, error\)](<#LessonRepository.CountByCourse>)
  - [func \(r \*LessonRepository\) Create\(ctx context.Context, courseID, categoryID string, lesson models.LessonCreate\) \(map\[string\]interface\{\}, error\)](<#LessonRepository.Create>)
  - [func \(r \*LessonRepository\) GetByCourse\(ctx context.Context, categoryID, courseID string, limit, offset int\) \(\[\]map\[string\]interface\{\}, error\)](<#LessonRepository.GetByCourse>)
  - [func \(r \*LessonRepository\) GetByIDAndCourse\(ctx context.Context, id, categoryID, courseID string\) \(map\[string\]interface\{\}, error\)](<#LessonRepository.GetByIDAndCourse>)
  - [func \(r \*LessonRepository\) ParseContent\(data map\[string\]interface\{\}\) \(map\[string\]interface\{\}, error\)](<#LessonRepository.ParseContent>)
  - [func \(r \*LessonRepository\) Update\(ctx context.Context, id, courseID string, lesson models.LessonUpdate\) \(map\[string\]interface\{\}, error\)](<#LessonRepository.Update>)


<a name="BaseRepository"></a>
## type [BaseRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L27-L31>)

BaseRepository \- базовый репозиторий для всех сущностей. Предоставляет общие методы для работы с базой данных.

```go
type BaseRepository struct {
    // contains filtered or unexported fields
}
```

<a name="NewBaseRepository"></a>
### func [NewBaseRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L42>)

```go
func NewBaseRepository(db *database.Database, tableName, schema string) *BaseRepository
```

NewBaseRepository создает новый базовый репозиторий.

Параметры:

- db: указатель на соединение с базой данных
- tableName: имя таблицы для операций
- schema: имя схемы \(может быть пустой строкой\)

Возвращает:

- \*BaseRepository: указатель на новый экземпляр BaseRepository

<a name="BaseRepository.Count"></a>
### func \(\*BaseRepository\) [Count](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L114>)

```go
func (r *BaseRepository) Count(ctx context.Context, whereClause string, params ...interface{}) (int, error)
```

Count выполняет запрос COUNT для подсчета количества записей.

Параметры:

- ctx: контекст выполнения запроса
- whereClause: условие WHERE для фильтрации \(может быть пустым\)
- params: параметры для подстановки в условие WHERE

Возвращает:

- int: количество найденных записей
- error: ошибка, если произошла

<a name="BaseRepository.Delete"></a>
### func \(\*BaseRepository\) [Delete](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L141>)

```go
func (r *BaseRepository) Delete(ctx context.Context, id string) (bool, error)
```

Delete выполняет запрос DELETE для удаления записи по уникальному идентификатору.

Параметры:

- ctx: контекст выполнения запроса
- id: уникальный идентификатор записи для удаления

Возвращает:

- bool: true, если запись была удалена, false \- если запись не найдена
- error: ошибка, если произошла

<a name="BaseRepository.Exists"></a>
### func \(\*BaseRepository\) [Exists](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L159>)

```go
func (r *BaseRepository) Exists(ctx context.Context, id string) (bool, error)
```

Exists выполняет запрос для проверки существования записи по уникальному идентификатору.

Параметры:

- ctx: контекст выполнения запроса
- id: уникальный идентификатор записи

Возвращает:

- bool: true, если запись существует, false \- если не существует
- error: ошибка, если произошла

<a name="BaseRepository.FullTableName"></a>
### func \(\*BaseRepository\) [FullTableName](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L54>)

```go
func (r *BaseRepository) FullTableName() string
```

FullTableName возвращает полное имя таблицы в формате "схема.таблица".

Возвращает:

- string: полное имя таблицы, включая схему \(если указана\)

<a name="BaseRepository.GetAll"></a>
### func \(\*BaseRepository\) [GetAll](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L87>)

```go
func (r *BaseRepository) GetAll(ctx context.Context, limit, offset int, orderBy, orderDir string) ([]map[string]interface{}, error)
```

GetAll выполняет запрос SELECT для получения всех записей с пагинацией и сортировкой.

Параметры:

- ctx: контекст выполнения запроса
- limit: максимальное количество записей
- offset: смещение от начала
- orderBy: поле для сортировки \(по умолчанию "created\_at"\)
- orderDir: направление сортировки \(по умолчанию "DESC"\)

Возвращает:

- \[\]map\[string\]interface\{\}: список найденных записей
- error: ошибка, если произошла

<a name="BaseRepository.GetByID"></a>
### func \(\*BaseRepository\) [GetByID](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L70>)

```go
func (r *BaseRepository) GetByID(ctx context.Context, id string) (map[string]interface{}, error)
```

GetByID выполняет запрос SELECT для получения записи по уникальному идентификатору.

Параметры:

- ctx: контекст выполнения запроса
- id: уникальный идентификатор записи

Возвращает:

- map\[string\]interface\{\}: найденная запись в виде map
- error: ошибка, если произошла

<a name="BaseRepository.GetFiltered"></a>
### func \(\*BaseRepository\) [GetFiltered](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/base.go#L180>)

```go
func (r *BaseRepository) GetFiltered(ctx context.Context, conditions []string, params []interface{}, orderBy, orderDir string) ([]map[string]interface{}, error)
```

GetFiltered выполняет запрос SELECT для получения записей с фильтрацией.

Параметры:

- ctx: контекст выполнения запроса
- conditions: список условий WHERE для фильтрации
- params: параметры для подстановки в условия
- orderBy: поле для сортировки \(по умолчанию "created\_at"\)
- orderDir: направление сортировки \(по умолчанию "DESC"\)

Возвращает:

- \[\]map\[string\]interface\{\}: список найденных записей
- error: ошибка, если произошла

<a name="CategoryRepository"></a>
## type [CategoryRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L13-L15>)

CategoryRepository \- репозиторий для работы с категориями в базе данных

Репозиторий предоставляет методы для выполнения CRUD операций с категориями курсов в базе данных.

```go
type CategoryRepository struct {
    *BaseRepository
}
```

<a name="NewCategoryRepository"></a>
### func [NewCategoryRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L24>)

```go
func NewCategoryRepository(db *database.Database) *CategoryRepository
```

NewCategoryRepository создает новый репозиторий для категорий

Параметры:

- db: экземпляр базы данных

Возвращает:

- \*CategoryRepository: указатель на новый репозиторий

<a name="CategoryRepository.CountCoursesForCategory"></a>
### func \(\*CategoryRepository\) [CountCoursesForCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L78>)

```go
func (r *CategoryRepository) CountCoursesForCategory(ctx context.Context, categoryID string) (int, error)
```

CountCoursesForCategory подсчитывает количество курсов в указанной категории

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории

Возвращает:

- int: количество курсов
- error: ошибка выполнения \(если есть\)

<a name="CategoryRepository.Create"></a>
### func \(\*CategoryRepository\) [Create](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L39>)

```go
func (r *CategoryRepository) Create(ctx context.Context, title string) (map[string]interface{}, error)
```

Create создает новую категорию в базе данных

Параметры:

- ctx: контекст выполнения
- title: название категории

Возвращает:

- map\[string\]interface\{\}: созданный объект категории
- error: ошибка выполнения \(если есть\)

<a name="CategoryRepository.GetAllWithCourses"></a>
### func \(\*CategoryRepository\) [GetAllWithCourses](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L117>)

```go
func (r *CategoryRepository) GetAllWithCourses(ctx context.Context) ([]map[string]interface{}, error)
```

GetAllWithCourses получает все категории с количеством курсов в каждой

Параметры:

- ctx: контекст выполнения

Возвращает:

- \[\]map\[string\]interface\{\}: список категорий с количеством курсов
- error: ошибка выполнения \(если есть\)

<a name="CategoryRepository.GetByTitle"></a>
### func \(\*CategoryRepository\) [GetByTitle](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L104>)

```go
func (r *CategoryRepository) GetByTitle(ctx context.Context, title string) (map[string]interface{}, error)
```

GetByTitle получает категорию по ее названию

Параметры:

- ctx: контекст выполнения
- title: название категории

Возвращает:

- map\[string\]interface\{\}: найденная категория или nil
- error: ошибка выполнения \(если есть\)

<a name="CategoryRepository.Update"></a>
### func \(\*CategoryRepository\) [Update](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/category.go#L59>)

```go
func (r *CategoryRepository) Update(ctx context.Context, id, title string) (map[string]interface{}, error)
```

Update обновляет существующую категорию в базе данных

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор категории
- title: новое название категории

Возвращает:

- map\[string\]interface\{\}: обновленный объект категории
- error: ошибка выполнения \(если есть\)

<a name="CourseRepository"></a>
## type [CourseRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L16-L18>)

CourseRepository \- репозиторий для работы с курсами в базе данных

Репозиторий предоставляет методы для выполнения CRUD операций с курсами в базе данных, включая фильтрацию и пагинацию.

```go
type CourseRepository struct {
    *BaseRepository
}
```

<a name="NewCourseRepository"></a>
### func [NewCourseRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L27>)

```go
func NewCourseRepository(db *database.Database) *CourseRepository
```

NewCourseRepository создает новый репозиторий для курсов

Параметры:

- db: экземпляр базы данных

Возвращает:

- \*CourseRepository: указатель на новый репозиторий

<a name="CourseRepository.Create"></a>
### func \(\*CourseRepository\) [Create](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L42>)

```go
func (r *CourseRepository) Create(ctx context.Context, course models.CourseCreate) (map[string]interface{}, error)
```

Create создает новый курс в базе данных

Параметры:

- ctx: контекст выполнения
- course: данные для создания курса

Возвращает:

- map\[string\]interface\{\}: созданный объект курса
- error: ошибка выполнения \(если есть\)

<a name="CourseRepository.ExistsByCategory"></a>
### func \(\*CourseRepository\) [ExistsByCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L197>)

```go
func (r *CourseRepository) ExistsByCategory(ctx context.Context, categoryID string) (bool, error)
```

ExistsByCategory проверяет существование категории

Используется для валидации перед операциями с курсами.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории

Возвращает:

- bool: true, если категория существует
- error: ошибка выполнения \(если есть\)

<a name="CourseRepository.GetByCategory"></a>
### func \(\*CourseRepository\) [GetByCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L176>)

```go
func (r *CourseRepository) GetByCategory(ctx context.Context, categoryID string) ([]map[string]interface{}, error)
```

GetByCategory получает все курсы указанной категории

Возвращает курсы, отсортированные по дате создания.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории

Возвращает:

- \[\]map\[string\]interface\{\}: список курсов категории
- error: ошибка выполнения \(если есть\)

<a name="CourseRepository.GetFiltered"></a>
### func \(\*CourseRepository\) [GetFiltered](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L108>)

```go
func (r *CourseRepository) GetFiltered(ctx context.Context, filter models.CourseFilter) ([]map[string]interface{}, int, error)
```

GetFiltered получает курсы с фильтрацией и пагинацией

Поддерживает фильтрацию по уровню сложности, видимости и категории. Возвращает отсортированные по дате создания курсы.

Параметры:

- ctx: контекст выполнения
- filter: фильтр для поиска курсов

Возвращает:

- \[\]map\[string\]interface\{\}: список курсов
- int: общее количество курсов
- error: ошибка выполнения \(если есть\)

<a name="CourseRepository.Update"></a>
### func \(\*CourseRepository\) [Update](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/course.go#L72>)

```go
func (r *CourseRepository) Update(ctx context.Context, id string, course models.CourseUpdate) (map[string]interface{}, error)
```

Update обновляет существующий курс в базе данных

Использует COALESCE для частичного обновления \- если значение равно nil, оно не изменяется.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор курса
- course: данные для обновления курса

Возвращает:

- map\[string\]interface\{\}: обновленный объект курса
- error: ошибка выполнения \(если есть\)

<a name="LessonRepository"></a>
## type [LessonRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L15-L17>)

LessonRepository \- репозиторий для работы с уроками в базе данных

Репозиторий предоставляет методы для выполнения CRUD операций с уроками, включая работу с JSON\-контентом.

```go
type LessonRepository struct {
    *BaseRepository
}
```

<a name="NewLessonRepository"></a>
### func [NewLessonRepository](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L26>)

```go
func NewLessonRepository(db *database.Database) *LessonRepository
```

NewLessonRepository создает новый репозиторий для уроков

Параметры:

- db: экземпляр базы данных

Возвращает:

- \*LessonRepository: указатель на новый репозиторий

<a name="LessonRepository.CountByCourse"></a>
### func \(\*LessonRepository\) [CountByCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L156>)

```go
func (r *LessonRepository) CountByCourse(ctx context.Context, categoryID, courseID string) (int, error)
```

CountByCourse подсчитывает количество уроков в указанном курсе

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории
- courseID: уникальный идентификатор курса

Возвращает:

- int: количество уроков
- error: ошибка выполнения \(если есть\)

<a name="LessonRepository.Create"></a>
### func \(\*LessonRepository\) [Create](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L45>)

```go
func (r *LessonRepository) Create(ctx context.Context, courseID, categoryID string, lesson models.LessonCreate) (map[string]interface{}, error)
```

Create создает новый урок в базе данных

Преобразует контент урока в JSON формат для хранения.

Параметры:

- ctx: контекст выполнения
- courseID: уникальный идентификатор курса
- categoryID: уникальный идентификатор категории
- lesson: данные для создания урока

Возвращает:

- map\[string\]interface\{\}: созданный объект урока
- error: ошибка выполнения \(если есть\)

<a name="LessonRepository.GetByCourse"></a>
### func \(\*LessonRepository\) [GetByCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L113>)

```go
func (r *LessonRepository) GetByCourse(ctx context.Context, categoryID, courseID string, limit, offset int) ([]map[string]interface{}, error)
```

GetByCourse получает уроки указанного курса

Возвращает уроки, отсортированные по дате создания.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории
- courseID: уникальный идентификатор курса
- limit: количество элементов
- offset: смещение

Возвращает:

- \[\]map\[string\]interface\{\}: список уроков
- error: ошибка выполнения \(если есть\)

<a name="LessonRepository.GetByIDAndCourse"></a>
### func \(\*LessonRepository\) [GetByIDAndCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L137>)

```go
func (r *LessonRepository) GetByIDAndCourse(ctx context.Context, id, categoryID, courseID string) (map[string]interface{}, error)
```

GetByIDAndCourse получает урок по уникальному идентификатору и курсу

Проверяет принадлежность урока указанной категории и курсу.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор урока
- categoryID: уникальный идентификатор категории
- courseID: уникальный идентификатор курса

Возвращает:

- map\[string\]interface\{\}: найденный урок или nil
- error: ошибка выполнения \(если есть\)

<a name="LessonRepository.ParseContent"></a>
### func \(\*LessonRepository\) [ParseContent](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L185>)

```go
func (r *LessonRepository) ParseContent(data map[string]interface{}) (map[string]interface{}, error)
```

ParseContent парсит JSON контент урока

Преобразует JSON\-данные из базы данных в map\[string\]interface\{\}. Если парсинг не удается, возвращает пустой map.

Параметры:

- data: данные урока с JSON\-контентом

Возвращает:

- map\[string\]interface\{\}: данные с распарсенным контентом
- error: ошибка выполнения \(если есть\)

<a name="LessonRepository.Update"></a>
### func \(\*LessonRepository\) [Update](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/repositories/lesson.go#L77>)

```go
func (r *LessonRepository) Update(ctx context.Context, id, courseID string, lesson models.LessonUpdate) (map[string]interface{}, error)
```

Update обновляет существующий урок в базе данных

Преобразует контент урока в JSON формат для хранения. Использует COALESCE для частичного обновления.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор урока
- courseID: уникальный идентификатор курса
- lesson: данные для обновления урока

Возвращает:

- map\[string\]interface\{\}: обновленный объект урока
- error: ошибка выполнения \(если есть\)

# services

```go
import "adminPanel/services"
```

Package services реализует бизнес\-логику для admin panel

Пакет содержит сервисы для работы с сущностями:

- CategoryService: работа с категориями
- CourseService: работа с курсами
- LessonService: работа с уроками

Каждый сервис отвечает за:

- Валидацию данных
- Бизнес\-логику операций
- Интеграцию с репозиториями
- Трассировку операций

Package services содержит бизнес\-логику приложения. Этот пакет предоставляет сервисы для работы с категориями, курсами и уроками.

## Index

- [type CategoryService](<#CategoryService>)
  - [func NewCategoryService\(categoryRepo \*repositories.CategoryRepository\) \*CategoryService](<#NewCategoryService>)
  - [func \(s \*CategoryService\) CreateCategory\(ctx context.Context, input models.CategoryCreate\) \(\*models.Category, error\)](<#CategoryService.CreateCategory>)
  - [func \(s \*CategoryService\) DeleteCategory\(ctx context.Context, id string\) error](<#CategoryService.DeleteCategory>)
  - [func \(s \*CategoryService\) GetCategories\(ctx context.Context\) \(\[\]models.Category, error\)](<#CategoryService.GetCategories>)
  - [func \(s \*CategoryService\) GetCategory\(ctx context.Context, id string\) \(\*models.Category, error\)](<#CategoryService.GetCategory>)
  - [func \(s \*CategoryService\) UpdateCategory\(ctx context.Context, id string, input models.CategoryUpdate\) \(\*models.Category, error\)](<#CategoryService.UpdateCategory>)
- [type CourseService](<#CourseService>)
  - [func NewCourseService\(courseRepo \*repositories.CourseRepository, categoryRepo \*repositories.CategoryRepository\) \*CourseService](<#NewCourseService>)
  - [func \(s \*CourseService\) CreateCourse\(ctx context.Context, input models.CourseCreate\) \(\*models.CourseResponse, error\)](<#CourseService.CreateCourse>)
  - [func \(s \*CourseService\) DeleteCourse\(ctx context.Context, categoryID, id string\) error](<#CourseService.DeleteCourse>)
  - [func \(s \*CourseService\) GetCategoryCourses\(ctx context.Context, categoryID string\) \(\[\]models.Course, error\)](<#CourseService.GetCategoryCourses>)
  - [func \(s \*CourseService\) GetCourse\(ctx context.Context, categoryID, id string\) \(\*models.CourseResponse, error\)](<#CourseService.GetCourse>)
  - [func \(s \*CourseService\) GetCourses\(ctx context.Context, filter models.CourseFilter\) \(\*models.PaginatedCoursesResponse, error\)](<#CourseService.GetCourses>)
  - [func \(s \*CourseService\) UpdateCourse\(ctx context.Context, categoryID, id string, input models.CourseUpdate\) \(\*models.CourseResponse, error\)](<#CourseService.UpdateCourse>)
- [type LessonService](<#LessonService>)
  - [func NewLessonService\(lessonRepo \*repositories.LessonRepository, courseRepo \*repositories.CourseRepository\) \*LessonService](<#NewLessonService>)
  - [func \(s \*LessonService\) CreateLesson\(ctx context.Context, courseID string, input models.LessonCreate\) \(\*models.LessonResponse, error\)](<#LessonService.CreateLesson>)
  - [func \(s \*LessonService\) DeleteLesson\(ctx context.Context, id, courseID, categoryID string\) error](<#LessonService.DeleteLesson>)
  - [func \(s \*LessonService\) GetLesson\(ctx context.Context, id, courseID, categoryID string\) \(\*models.LessonResponse, error\)](<#LessonService.GetLesson>)
  - [func \(s \*LessonService\) GetLessons\(ctx context.Context, categoryID, courseID, pageStr, limitStr string\) \(\[\]models.Lesson, models.Pagination, error\)](<#LessonService.GetLessons>)
  - [func \(s \*LessonService\) UpdateLesson\(ctx context.Context, id, courseID, categoryID string, input models.LessonUpdate\) \(\*models.LessonResponse, error\)](<#LessonService.UpdateLesson>)


<a name="CategoryService"></a>
## type [CategoryService](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L42-L44>)

CategoryService \- сервис для работы с категориями курсов

Сервис предоставляет методы для управления категориями:

- Получение списка категорий
- Получение категории по ID
- Создание новой категории
- Обновление категории
- Удаление категории

Особенности:

- Проверка уникальности названий
- Контроль связанных курсов при удалении
- Интеграция с OpenTelemetry для трассировки

```go
type CategoryService struct {
    // contains filtered or unexported fields
}
```

<a name="NewCategoryService"></a>
### func [NewCategoryService](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L55>)

```go
func NewCategoryService(categoryRepo *repositories.CategoryRepository) *CategoryService
```

NewCategoryService создает новый сервис для работы с категориями

Параметры:

- categoryRepo: репозиторий для работы с категориями

Возвращает:

- \*CategoryService: указатель на новый сервис

<a name="CategoryService.CreateCategory"></a>
### func \(\*CategoryService\) [CreateCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L146>)

```go
func (s *CategoryService) CreateCategory(ctx context.Context, input models.CategoryCreate) (*models.Category, error)
```

CreateCategory создает новую категорию

Перед созданием проверяет уникальность названия категории.

Параметры:

- ctx: контекст выполнения
- input: данные для создания категории

Возвращает:

- \*models.Category: созданная категория
- error: ошибка выполнения \(если есть\)

<a name="CategoryService.DeleteCategory"></a>
### func \(\*CategoryService\) [DeleteCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L249>)

```go
func (s *CategoryService) DeleteCategory(ctx context.Context, id string) error
```

DeleteCategory удаляет категорию по уникальному идентификатору

Перед удалением проверяет наличие связанных курсов. Категория с курсами не может быть удалена.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор категории

Возвращает:

- error: ошибка выполнения \(если есть\)

<a name="CategoryService.GetCategories"></a>
### func \(\*CategoryService\) [GetCategories](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L71>)

```go
func (s *CategoryService) GetCategories(ctx context.Context) ([]models.Category, error)
```

GetCategories получает список всех категорий

Метод возвращает все доступные категории, отсортированные по названию.

Параметры:

- ctx: контекст выполнения

Возвращает:

- \[\]models.Category: список категорий
- error: ошибка выполнения \(если есть\)

<a name="CategoryService.GetCategory"></a>
### func \(\*CategoryService\) [GetCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L107>)

```go
func (s *CategoryService) GetCategory(ctx context.Context, id string) (*models.Category, error)
```

GetCategory получает категорию по уникальному идентификатору

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор категории

Возвращает:

- \*models.Category: указатель на категорию
- error: ошибка выполнения \(если есть\)

<a name="CategoryService.UpdateCategory"></a>
### func \(\*CategoryService\) [UpdateCategory](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/category.go#L188>)

```go
func (s *CategoryService) UpdateCategory(ctx context.Context, id string, input models.CategoryUpdate) (*models.Category, error)
```

UpdateCategory обновляет существующую категорию

Проверяет существование категории и уникальность нового названия.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор категории
- input: данные для обновления категории

Возвращает:

- \*models.Category: обновленная категория
- error: ошибка выполнения \(если есть\)

<a name="CourseService"></a>
## type [CourseService](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L32-L35>)

CourseService \- сервис для работы с курсами

Сервис предоставляет методы для управления курсами:

- Получение курсов с фильтрацией и пагинацией
- Получение курса по ID
- Создание нового курса
- Обновление курса
- Удаление курса
- Получение курсов категории

Особенности:

- Проверка существования категорий
- Фильтрация по уровню сложности и видимости
- Интеграция с OpenTelemetry для трассировки
- Валидация данных

```go
type CourseService struct {
    // contains filtered or unexported fields
}
```

<a name="NewCourseService"></a>
### func [NewCourseService](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L47-L50>)

```go
func NewCourseService(courseRepo *repositories.CourseRepository, categoryRepo *repositories.CategoryRepository) *CourseService
```

NewCourseService создает новый сервис для работы с курсами

Параметры:

- courseRepo: репозиторий для работы с курсами
- categoryRepo: репозиторий для работы с категориями

Возвращает:

- \*CourseService: указатель на новый сервис

<a name="CourseService.CreateCourse"></a>
### func \(\*CourseService\) [CreateCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L205>)

```go
func (s *CourseService) CreateCourse(ctx context.Context, input models.CourseCreate) (*models.CourseResponse, error)
```

CreateCourse создает новый курс в указанной категории

Устанавливает значения по умолчанию для уровня и видимости.

Параметры:

- ctx: контекст выполнения
- input: данные для создания курса

Возвращает:

- \*models.CourseResponse: ответ с созданным курсом
- error: ошибка выполнения \(если есть\)

<a name="CourseService.DeleteCourse"></a>
### func \(\*CourseService\) [DeleteCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L333>)

```go
func (s *CourseService) DeleteCourse(ctx context.Context, categoryID, id string) error
```

DeleteCourse удаляет курс по уникальному идентификатору

Проверяет принадлежность курса указанной категории.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории
- id: уникальный идентификатор курса

Возвращает:

- error: ошибка выполнения \(если есть\)

<a name="CourseService.GetCategoryCourses"></a>
### func \(\*CourseService\) [GetCategoryCourses](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L372>)

```go
func (s *CourseService) GetCategoryCourses(ctx context.Context, categoryID string) ([]models.Course, error)
```

GetCategoryCourses получает все курсы указанной категории

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории

Возвращает:

- \[\]models.Course: список курсов категории
- error: ошибка выполнения \(если есть\)

<a name="CourseService.GetCourse"></a>
### func \(\*CourseService\) [GetCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L155>)

```go
func (s *CourseService) GetCourse(ctx context.Context, categoryID, id string) (*models.CourseResponse, error)
```

GetCourse получает курс по уникальному идентификатору

Проверяет принадлежность курса указанной категории.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории
- id: уникальный идентификатор курса

Возвращает:

- \*models.CourseResponse: ответ с курсом
- error: ошибка выполнения \(если есть\)

<a name="CourseService.GetCourses"></a>
### func \(\*CourseService\) [GetCourses](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L69>)

```go
func (s *CourseService) GetCourses(ctx context.Context, filter models.CourseFilter) (*models.PaginatedCoursesResponse, error)
```

GetCourses получает курсы с фильтрацией и пагинацией

Метод возвращает курсы указанной категории с возможностью фильтрации по уровню сложности и видимости.

Параметры:

- ctx: контекст выполнения
- filter: фильтр для поиска курсов

Возвращает:

- \*models.PaginatedCoursesResponse: ответ с курсами и пагинацией
- error: ошибка выполнения \(если есть\)

<a name="CourseService.UpdateCourse"></a>
### func \(\*CourseService\) [UpdateCourse](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/course.go#L272>)

```go
func (s *CourseService) UpdateCourse(ctx context.Context, categoryID, id string, input models.CourseUpdate) (*models.CourseResponse, error)
```

UpdateCourse обновляет существующий курс

Проверяет принадлежность курса указанной категории.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории
- id: уникальный идентификатор курса
- input: данные для обновления курса

Возвращает:

- \*models.CourseResponse: ответ с обновленным курсом
- error: ошибка выполнения \(если есть\)

<a name="LessonService"></a>
## type [LessonService](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L31-L34>)

LessonService \- сервис для работы с уроками

Сервис предоставляет методы для управления уроками:

- Получение уроков курса с пагинацией
- Получение урока по ID
- Создание нового урока
- Обновление урока
- Удаление урока

Особенности:

- Проверка принадлежности уроков курсам и категориям
- Парсинг контента уроков
- Интеграция с OpenTelemetry для трассировки
- Валидация данных

```go
type LessonService struct {
    // contains filtered or unexported fields
}
```

<a name="NewLessonService"></a>
### func [NewLessonService](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L46-L49>)

```go
func NewLessonService(lessonRepo *repositories.LessonRepository, courseRepo *repositories.CourseRepository) *LessonService
```

NewLessonService создает новый сервис для работы с уроками

Параметры:

- lessonRepo: репозиторий для работы с уроками
- courseRepo: репозиторий для работы с курсами

Возвращает:

- \*LessonService: указатель на новый сервис

<a name="LessonService.CreateLesson"></a>
### func \(\*LessonService\) [CreateLesson](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L218>)

```go
func (s *LessonService) CreateLesson(ctx context.Context, courseID string, input models.LessonCreate) (*models.LessonResponse, error)
```

CreateLesson создает новый урок в указанном курсе

Проверяет существование курса и его принадлежность категории. Парсит контент урока.

Параметры:

- ctx: контекст выполнения
- courseID: уникальный идентификатор курса
- input: данные для создания урока

Возвращает:

- \*models.LessonResponse: ответ с созданным уроком
- error: ошибка выполнения \(если есть\)

<a name="LessonService.DeleteLesson"></a>
### func \(\*LessonService\) [DeleteLesson](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L349>)

```go
func (s *LessonService) DeleteLesson(ctx context.Context, id, courseID, categoryID string) error
```

DeleteLesson удаляет урок по уникальному идентификатору

Проверяет существование урока и его принадлежность курсу и категории.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор урока
- courseID: уникальный идентификатор курса
- categoryID: уникальный идентификатор категории

Возвращает:

- error: ошибка выполнения \(если есть\)

<a name="LessonService.GetLesson"></a>
### func \(\*LessonService\) [GetLesson](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L154>)

```go
func (s *LessonService) GetLesson(ctx context.Context, id, courseID, categoryID string) (*models.LessonResponse, error)
```

GetLesson получает урок по уникальному идентификатору

Проверяет существование курса, его принадлежность категории и наличие урока в этом курсе.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор урока
- courseID: уникальный идентификатор курса
- categoryID: уникальный идентификатор категории

Возвращает:

- \*models.LessonResponse: ответ с уроком и его содержимым
- error: ошибка выполнения \(если есть\)

<a name="LessonService.GetLessons"></a>
### func \(\*LessonService\) [GetLessons](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L71>)

```go
func (s *LessonService) GetLessons(ctx context.Context, categoryID, courseID, pageStr, limitStr string) ([]models.Lesson, models.Pagination, error)
```

GetLessons получает уроки указанного курса с пагинацией

Проверяет существование курса и его принадлежность категории.

Параметры:

- ctx: контекст выполнения
- categoryID: уникальный идентификатор категории
- courseID: уникальный идентификатор курса
- pageStr: номер страницы \(строка\)
- limitStr: количество элементов на странице \(строка\)

Возвращает:

- \[\]models.Lesson: список уроков
- models.Pagination: информация о пагинации
- error: ошибка выполнения \(если есть\)

<a name="LessonService.UpdateLesson"></a>
### func \(\*LessonService\) [UpdateLesson](<https://github.com/TaurineMerge/LMS_Tages/blob/main/adminPanel/services/lesson.go#L286>)

```go
func (s *LessonService) UpdateLesson(ctx context.Context, id, courseID, categoryID string, input models.LessonUpdate) (*models.LessonResponse, error)
```

UpdateLesson обновляет существующий урок

Проверяет существование урока и его принадлежность курсу и категории. Парсит контент урока.

Параметры:

- ctx: контекст выполнения
- id: уникальный идентификатор урока
- courseID: уникальный идентификатор курса
- categoryID: уникальный идентификатор категории
- input: данные для обновления урока

Возвращает:

- \*models.LessonResponse: ответ с обновленным уроком
- error: ошибка выполнения \(если есть\)

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)

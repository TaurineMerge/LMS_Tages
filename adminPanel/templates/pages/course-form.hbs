<!-- templates/pages/course-form.hbs -->
<div class="admin-page admin-page--full">
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="admin-content admin-content--full admin-content--centered">
        {{#if error}}
            <div class="notification notification--error">
                <span class="notification__icon">‚ö†Ô∏è</span>
                <span class="notification__text">{{error}}</span>
            </div>
        {{/if}}

        <div class="form-card">
            <div class="form-card__header">
                <nav class="form-breadcrumb">
                    <a href="/admin/categories" class="form-breadcrumb__link">üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
                    <span class="form-breadcrumb__separator">‚Ä∫</span>
                    <a href="/admin/categories/{{categoryID}}/courses" class="form-breadcrumb__link">{{categoryName}}</a>
                    <span class="form-breadcrumb__separator">‚Ä∫</span>
                    <span>{{#if course}}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ{{else}}–ù–æ–≤—ã–π –∫—É—Ä—Å{{/if}}</span>
                </nav>
                <h1 class="form-card__title">
                    {{#if course}}‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—É—Ä—Å{{else}}üìö –ù–æ–≤—ã–π –∫—É—Ä—Å{{/if}}
                </h1>
                <p class="form-card__subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫—É—Ä—Å–µ</p>
            </div>

            {{#if course}}
            <div class="form-info-bar">
                <div class="form-info-bar__item">
                    <span class="form-info-bar__label">ID:</span>
                    <span class="form-info-bar__value">{{course.ID}}</span>
                </div>
                <div class="form-info-bar__item">
                    <span class="form-info-bar__label">–°–æ–∑–¥–∞–Ω:</span>
                    <span class="form-info-bar__value">{{course.CreatedAt}}</span>
                </div>
                <div class="form-info-bar__item">
                    <span class="form-info-bar__label">–û–±–Ω–æ–≤–ª–µ–Ω:</span>
                    <span class="form-info-bar__value">{{course.UpdatedAt}}</span>
                </div>
            </div>
            {{/if}}

            <form method="POST" 
                  action="{{#if course}}/admin/categories/{{categoryID}}/courses/{{course.ID}}/update{{else}}/admin/categories/{{categoryID}}/courses/create{{/if}}" 
                  enctype="multipart/form-data"
                  class="modern-form">
                
                <div class="form-section">
                    <h3 class="form-section__title">
                        <span class="form-section__icon">üìã</span>
                        –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                    </h3>

                    <div class="form-field">
                        <label for="title" class="form-field__label">
                            <span class="form-field__label-icon">üìù</span>
                            –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞
                            <span class="form-field__required">*</span>
                        </label>
                        <div class="form-field__input-wrapper">
                            <input 
                                type="text" 
                                id="title" 
                                name="title" 
                                class="form-field__input" 
                                value="{{#if course}}{{course.Title}}{{/if}}"
                                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –í–≤–µ–¥–µ–Ω–∏–µ –≤ Python"
                                required
                                autofocus
                            />
                            <span class="form-field__input-icon">‚úì</span>
                        </div>
                        <p class="form-field__hint">–ö—Ä–∞—Ç–∫–æ–µ –∏ –ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞</p>
                    </div>

                    <div class="form-field">
                        <label for="description" class="form-field__label">
                            <span class="form-field__label-icon">üìÑ</span>
                            –û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞
                        </label>
                        <textarea 
                            id="description" 
                            name="description" 
                            class="form-field__textarea" 
                            placeholder="–û–ø–∏—à–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∫—É—Ä—Å–∞, —á–µ–º—É —Å—Ç—É–¥–µ–Ω—Ç—ã –Ω–∞—É—á–∞—Ç—Å—è..."
                        >{{#if course}}{{course.Description}}{{/if}}</textarea>
                        <p class="form-field__hint">–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</p>
                    <div class="form-field">
                        <label for="image" class="form-field__label">
                            <span class="form-field__label-icon">üñºÔ∏è</span>
                            –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–∞
                        </label>
                        <div class="form-field__input-wrapper">
                            <input 
                                type="file" 
                                id="image" 
                                name="image" 
                                class="form-field__input" 
                                accept="image/*"
                            />
                            <span class="form-field__input-icon">üìé</span>
                        </div>
                        <p class="form-field__hint">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫—É—Ä—Å–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</p>
                        {{#if course.ImageKey}}
<div class="current-image">
    <p>–¢–µ–∫—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</p>
    <div class="image-preview">
        <span>üñºÔ∏è</span>
        <img src="{{s3Service.GetImageURL course.ImageKey}}" onload="this.style.display='block'; this.previousElementSibling.style.display='none';" onerror="this.closest('.current-image').style.display='none';" style="max-width: 200px; max-height: 200px;" />
    </div>
</div>
{{/if}}
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="form-section__title">
                        <span class="form-section__icon">‚öôÔ∏è</span>
                        –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—É—Ä—Å–∞
                    </h3>

                    <div class="form-row">
                        <div class="form-field form-field--half">
                            <label for="level" class="form-field__label">
                                <span class="form-field__label-icon">üìä</span>
                                –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                                <span class="form-field__required">*</span>
                            </label>
                            <div class="form-field__select-wrapper">
                                <select id="level" name="level" class="form-field__select" required>
                                    <option value="easy" {{#if course}}{{#if (eq course.Level "easy")}}selected{{/if}}{{/if}}>üü¢ –õ–µ–≥–∫–∏–π</option>
                                    <option value="medium" {{#if course}}{{#if (eq course.Level "medium")}}selected{{/if}}{{else}}selected{{/if}}>üü° –°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="hard" {{#if course}}{{#if (eq course.Level "hard")}}selected{{/if}}{{/if}}>üî¥ –°–ª–æ–∂–Ω—ã–π</option>
                                </select>
                                <span class="form-field__select-arrow">‚ñº</span>
                            </div>
                        </div>

                        <div class="form-field form-field--half">
                            <label class="form-field__label">
                                <span class="form-field__label-icon">üëÅÔ∏è</span>
                                –í–∏–¥–∏–º–æ—Å—Ç—å
                            </label>
                            <label class="toggle-switch">
                                <input 
                                    type="checkbox" 
                                    name="visible" 
                                    class="toggle-switch__input" 
                                    {{#if course}}
                                        {{#if course.Visible}}checked{{/if}}
                                    {{else}}
                                        checked
                                    {{/if}}
                                />
                                <span class="toggle-switch__slider"></span>
                                <span class="toggle-switch__label">–í–∏–¥–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç–∞–º</span>
                            </label>
                        </div>
                    </div>
                </div>

                {{#if course}}
                <div class="form-section">
                    <h3 class="form-section__title">
                        <span class="form-section__icon">üìù</span>
                        –¢–µ—Å—Ç—ã –∫—É—Ä—Å–∞
                    </h3>

                    <div class="form-field">
                        <p class="form-field__hint">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è —ç—Ç–æ–≥–æ –∫—É—Ä—Å–∞ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π –º–æ–¥—É–ª—å —Ç–µ—Å—Ç–æ–≤.</p>
                        <div class="form-actions form-actions--inline">
                            <a href="testing/web/tests/new?redirect={{redirectURL}}" class="btn btn--secondary">
                                <span class="btn__icon">Ôºã</span>
                                –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç
                            </a>
                            {{#if course.tests.draft}}
                            <a href="testing/web/tests/{{course.tests.draft.ID}}/draft" class="btn btn--secondary">
                                <span class="btn__icon">‚úèÔ∏è</span>
                                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫
                            </a>
                            {{/if}}
                            {{#if course.tests.published}}
                            <a href="testing/web/tests/{{course.tests.published.ID}}/edit" class="btn btn--secondary">
                                <span class="btn__icon">‚úèÔ∏è</span>
                                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç
                            </a>
                            {{/if}}
                        </div>
                    </div>
                </div>
                {{/if}}

                <div class="form-actions">
                    <a href="/admin/categories/{{categoryID}}/courses" class="btn btn--secondary">
                        <span class="btn__icon">‚úï</span>
                        –û—Ç–º–µ–Ω–∞
                    </a>
                    <button type="submit" class="btn btn--primary">
                        <span class="btn__icon">{{#if course}}üíæ{{else}}Ôºã{{/if}}</span>
                        {{#if course}}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è{{else}}–°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å{{/if}}
                    </button>
                </div>
            </form>
        </div>
    </main>
</div>

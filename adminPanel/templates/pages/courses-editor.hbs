<!-- templates/pages/courses-editor.hbs -->
<div class="admin-page admin-page--full">
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="admin-content admin-content--full">
        {{#if error}}
            <div class="notification notification--error">
                <span class="notification__icon">‚ö†Ô∏è</span>
                <span class="notification__text">{{error}}</span>
            </div>
        {{/if}}

        {{#if success}}
            <div class="notification notification--success">
                <span class="notification__icon">‚úì</span>
                <span class="notification__text">{{success}}</span>
            </div>
        {{/if}}

        <nav class="top-breadcrumb">
            <a href="/admin/categories" class="top-breadcrumb__link">üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
            <span class="top-breadcrumb__separator">‚Ä∫</span>
            <span class="top-breadcrumb__current">{{categoryName}}</span>
        </nav>

        <div class="content-header content-header--with-actions">
            <div class="content-header__text">
                <h1 class="content-title">üìö –ö—É—Ä—Å—ã: {{categoryName}}</h1>
                <p class="content-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Ä¢ {{coursesCount}} –∫—É—Ä—Å–æ–≤</p>
            </div>
            <div class="content-header__actions">
                <a href="/admin/categories" class="btn btn--secondary">
                    <span class="btn__icon">‚Üê</span>
                    –ù–∞–∑–∞–¥
                </a>
                <a href="/admin/categories/{{categoryID}}/courses/new" class="btn btn--primary">
                    <span class="btn__icon">Ôºã</span>
                    –ù–æ–≤—ã–π –∫—É—Ä—Å
                </a>
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="admin-filters">
            <form method="GET" action="/admin/categories/{{categoryID}}/courses" class="admin-filters__form">
                <div class="admin-filters__group">
                    <label class="admin-filters__label">–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                    <select name="level" class="admin-filters__select" onchange="this.form.submit()">
                        <option value="all" {{#if (eq levelFilter "all")}}selected{{/if}}>–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                        <option value="easy" {{#if (eq levelFilter "easy")}}selected{{/if}}>–õ—ë–≥–∫–∏–π</option>
                        <option value="medium" {{#if (eq levelFilter "medium")}}selected{{/if}}>–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="hard" {{#if (eq levelFilter "hard")}}selected{{/if}}>–°–ª–æ–∂–Ω—ã–π</option>
                    </select>
                </div>
                <div class="admin-filters__group">
                    <label class="admin-filters__label">–í–∏–¥–∏–º–æ—Å—Ç—å:</label>
                    <select name="visibility" class="admin-filters__select" onchange="this.form.submit()">
                        <option value="all" {{#if (eq visibilityFilter "all")}}selected{{/if}}>–í—Å–µ</option>
                        <option value="public" {{#if (eq visibilityFilter "public")}}selected{{/if}}>üëÅÔ∏è –í–∏–¥–∏–º—ã–µ</option>
                        <option value="draft" {{#if (eq visibilityFilter "draft")}}selected{{/if}}>üôà –°–∫—Ä—ã—Ç—ã–µ</option>
                    </select>
                </div>
            </form>
        </div>

        {{#if courses}}
            <div class="entity-grid">
                {{#each courses}}
                    <article class="entity-card entity-card--course">
                        <div class="entity-card__header">
                            <div class="entity-card__badges">
                                <span class="badge badge--level badge--{{Level}}">{{LevelRu}}</span>
                                {{#if Visible}}
                                    <span class="badge badge--visible">üëÅÔ∏è –í–∏–¥–µ–Ω</span>
                                {{else}}
                                    <span class="badge badge--hidden">üôà –°–∫—Ä—ã—Ç</span>
                                {{/if}}
                            </div>
                            <div class="entity-card__menu">
                                <input type="checkbox" id="menu-course-{{ID}}" class="entity-card__menu-toggle">
                                <label for="menu-course-{{ID}}" class="entity-card__menu-btn" title="–î–µ–π—Å—Ç–≤–∏—è">‚ãÆ</label>
                                <div class="entity-card__menu-dropdown">
                                    <a href="/admin/categories/{{CategoryID}}/courses/{{ID}}/lessons" class="entity-card__menu-item">
                                        <span>üìù</span> –£—Ä–æ–∫–∏
                                    </a>
                                    <a href="/admin/categories/{{CategoryID}}/courses/{{ID}}" class="entity-card__menu-item">
                                        <span>‚úèÔ∏è</span> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                    </a>
                                    <form method="POST" action="/admin/categories/{{CategoryID}}/courses/{{ID}}/delete" class="entity-card__menu-form">
                                        <button type="submit" class="entity-card__menu-item entity-card__menu-item--danger">
                                            <span>üóëÔ∏è</span> –£–¥–∞–ª–∏—Ç—å
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="entity-card__body">
                            <div class="entity-card__image-placeholder">
                                <span>üñºÔ∏è</span>
                                {{#if ImageKey}}
                                <img src="{{../s3Service.GetImageURL ImageKey}}" onload="this.style.display='block'; this.previousElementSibling.style.display='none';" />
                                {{/if}}
                            </div>
                            <h3 class="entity-card__title">{{Title}}</h3>
                            {{#if Description}}
                                <p class="entity-card__description">{{Description}}</p>
                            {{/if}}
                            <div class="entity-card__meta">
                                <span class="entity-card__meta-item">
                                    <span class="meta-icon">üïê</span>
                                    {{UpdatedAt}}
                                </span>
                            </div>
                        </div>

                        <div class="entity-card__footer">
                            <a href="/admin/categories/{{CategoryID}}/courses/{{ID}}/lessons" class="entity-card__action-btn">
                                <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞–º–∏</span>
                                <span class="entity-card__arrow">‚Üí</span>
                            </a>
                        </div>
                    </article>
                {{/each}}

                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
                <a href="/admin/categories/{{categoryID}}/courses/new" class="entity-card entity-card--add">
                    <div class="entity-card__add-content">
                        <span class="entity-card__add-icon">Ôºã</span>
                        <span class="entity-card__add-text">–î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å</span>
                    </div>
                </a>
            </div>
        {{else}}
            <div class="empty-state-modern">
                <div class="empty-state-modern__illustration">
                    <div class="empty-state-modern__circle"></div>
                    <div class="empty-state-modern__icon">üìö</div>
                </div>
                <h2 class="empty-state-modern__title">–ö—É—Ä—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h2>
                <p class="empty-state-modern__text">–ù–µ—Ç –∫—É—Ä—Å–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º</p>
                <div class="empty-state-modern__actions">
                    <a href="/admin/categories/{{categoryID}}/courses" class="btn btn--secondary">
                        <span class="btn__icon">‚Üª</span>
                        –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                    </a>
                    <a href="/admin/categories/{{categoryID}}/courses/new" class="btn btn--primary btn--lg">
                        <span class="btn__icon">Ôºã</span>
                        –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å
                    </a>
                </div>
            </div>
        {{/if}}
    </main>
</div>
